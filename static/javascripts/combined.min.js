var admin=admin||{};var booking=booking||{};var news=news||{};admin.initEventHandlers=function(){var e=$("#main-content");$("#news-add-btn").on("click",function(){$("#news-add-dlg").modal()});$("#news-add-save-btn").on("click",function(){var t=$("#news-add-title").val(),n=$("#news-add-content").val(),r=$("#news-image-url-placeholder").text(),i={title:t,content:n,user:1,image:r};var o=false;$.each([t,n],function(e,t){if(t==null||t==""){o=true}});if(o!=true){$.postJSON("/news_add",i,function(){$.get("admin",function(n){e.empty();e.html(n);admin.initEventHandlers();e.prepend('<div class="alert alert-success">DODANO nową aktualność: '+t+".</div>");s()})})}else{e.prepend('<div class="alert alert-danger">BŁĄD: Wszystkie pola są wymagane. Proszę poprawić.</div>')}});var t=$("#admin-news-manager-table");t.find("[action=delete]").on("click",function(){$.postJSON("news_delete",{id:this.value},function(){$.get("admin",function(t){e.empty();e.html(t);admin.initEventHandlers();s()})})});t.find("[action=edit]").on("click",function(){var e=$(this).parent().parent();var t=$(this).val();$("#news-edit-dlg").modal();var n=e.find("td[rel=title]").text(),r=e.find("td[rel=content]").text(),i=e.find("td[rel=image] > img").attr("src");$("#news-edit-title").val(n);$("#news-edit-content").text(r);$("#news-edit-item-id").text(t)});$("#news-edit-save-btn").on("click",function(){var t=$("#news-edit-title").val(),n=$("#news-edit-content").val(),r=$("#news-edit-image-url-placeholder").text(),i=$("#news-edit-item-id").text(),o={title:t,content:n,image:r,id:i};var u=false;$.each([t,n,i],function(e,t){if(t==null||t==""){u=true}});if(u==true){e.prepend('<div class="alert alert-danger">BŁĄD: Wszystkie pola są wymagane. Proszę poprawić.</div>')}else{$.postJSON("/news_edit",o,function(){$.get("admin",function(n){e.empty();e.html(n);admin.initEventHandlers();e.prepend('<div class="alert alert-success">ZMODYFIKOWANO aktualność: '+t+".</div>");s()})})}});$("#news-add-dlg-image-form").find(":button").click(function(){var e=new FormData($("#news-add-dlg-image-form")[0]);$.ajax({url:"/news_image_upload",type:"POST",success:function(e){$("#news-image-url-placeholder").text(e);$("#news-add-image-section").html('<div class="alert alert-success">DODANO: '+e+".</div>")},error:function(e){alert(e)},data:e,cache:false,contentType:false,processData:false})});$("#news-edit-dlg-image-form").find(":button").click(function(){var e=new FormData($("#news-edit-dlg-image-form")[0]);$.ajax({url:"/news_image_upload",type:"POST",success:function(e){$("#news-edit-image-url-placeholder").text(e);$("#news-edit-image-section").html('<div class="alert alert-success">DODANO: '+e+".</div>")},error:function(e){alert(e)},data:e,cache:false,contentType:false,processData:false})});$("#admin-events-manager-table").find("[action=delete]").on("click",function(){$.postJSON("events_delete",{id:this.value},function(){$.get("admin",function(t){e.empty();e.html(t);admin.initEventHandlers();o()})})});$("#event-add-btn").on("click",function(){$("#event-add-dlg").modal()});$("#admin-add-event-save-btn").on("click",function(){var t=$("#admin-add-event-date").val(),n=$("#admin-add-event-time-start").val(),r=$("#admin-add-event-time-end").val(),i=$("#admin-add-event-title").val(),s={date_start:t+" "+n,date_end:t+" "+r,title:i,user:1};var u=false;$.each([t,n,r,i],function(e,t){if(t==null||t==""){u=true}});if(u==true){e.prepend('<div class="alert alert-danger">BŁĄD: Wszystkie pola są wymagane. Proszę poprawić.</div>')}else{$.postJSON("/events_add",s,function(){$.get("admin",function(t){e.empty();e.html(t);admin.initEventHandlers();e.prepend('<div class="alert alert-success">DODANO: '+i+".</div>");o()})})}});var n=$("#admin-reservations-manager-table");n.find("[action=delete]").on("click",function(){$.postJSON("reservations_delete",{id:this.value},function(){$.get("admin",function(t){e.empty();e.html(t);admin.initEventHandlers();u()})})});n.parent().find("[action=edit]").on("click",function(){var e=$(this).parent().parent();var t=$(this).val();$("#reservations-edit-dlg").modal();var n=e.find("td[rel=date_start]").text(),r=e.find("td[rel=date_end]").text(),i=n.split(" ")[0],s=n.split(" ")[1],o=r.split(" ")[1],u=e.find("td[rel=title]").text(),a=e.find("td[rel=email]").text(),f=e.find("td[rel=phone]").text();$("#reservations-edit-title").val(u);$("#reservations-edit-email").val(a);$("#reservations-edit-phone").val(f);$("#reservations-edit-date").val(i);$("#reservations-edit-time-start").val(s);$("#reservations-edit-time-end").val(o);$("#reservations-edit-item-id").text(t)});$("#reservations-edit-save-btn").on("click",function(){var t=$("#reservations-edit-title").val(),n=$("#reservations-edit-email").val(),r=$("#reservations-edit-phone").val(),i=$("#reservations-edit-date").val(),s=$("#reservations-edit-time-start").val(),o=$("#reservations-edit-time-end").val(),a=$("#reservations-edit-item-id").text(),f={title:t,email:n,phone:r,date:i,time_start:s,time_end:o,id:a};var l=false;$.each([t,n,r,i,s,o,a],function(e,t){if(t==null||t==""){l=true}});if(l!=true){$.postJSON("/reservations_edit",f,function(){$.get("admin",function(n){e.empty();e.html(n);u();admin.initEventHandlers();e.prepend('<div class="alert alert-success">DODANO nową pozycję na karcie dań: '+t+".</div>")})})}else{e.prepend('<div class="alert alert-danger">BŁĄD: Wszystkie pola są wymagane. Proszę poprawić.</div>')}});$(".datepicker").datepicker({format:"yyyy-mm-dd",weekStart:1,autoclose:true});$(".timepicker").timepicker({showMeridian:false});$(".nav-tabs li").click(function(){e.find(".alert").remove()});$("#dishes-add-btn").on("click",function(){$("#dishes-add-dlg").modal()});$("#dishes-add-dlg-image-form").find(":button").click(function(){var e=new FormData($("#dishes-add-dlg-image-form")[0]);$.ajax({url:"/dishes_image_upload",type:"POST",success:function(e){$("#dishes-image-url-placeholder").text(e);$("#dishes-add-image-section").html('<div class="alert alert-success">DODANO: '+e+".</div>")},error:function(e){alert(e)},data:e,cache:false,contentType:false,processData:false})});$("#dishes-add-save-btn").on("click",function(){var t=$("#dishes-add-title").val(),n=$("#dishes-add-ingredients").val(),r=$("#dishes-add-price").val(),s=$("#dishes-add-type").val(),o=$("#dishes-image-url-placeholder").text(),u={title:t,ingredients:n,price:r,type:s,image:o};var a=false;$.each([t,r,s,n],function(e,t){if(t==null||t==""){a=true}});if(a!=true){$.postJSON("/dishes_add",u,function(){$.get("admin",function(n){e.empty();e.html(n);admin.initEventHandlers();e.prepend('<div class="alert alert-success">DODANO nową pozycję na karcie dań: '+t+".</div>");i()})})}else{e.prepend('<div class="alert alert-danger">BŁĄD: Wszystkie pola są wymagane. Proszę poprawić.</div>')}});var r=$("#admin-dishes-manager-table");r.find("[action=delete]").on("click",function(){$.postJSON("dishes_delete",{id:this.value},function(){$.get("admin",function(t){e.empty();e.html(t);admin.initEventHandlers();i()})})});r.parent().find("[action=edit]").on("click",function(){var e=$(this).parent().parent();var t=$(this).val();$("#dishes-edit-dlg").modal();var n=e.find("td[rel=title]").text(),r=e.find("td[rel=ingredients]").text(),i=e.find("td[rel=price]").text(),s=e.find("td[rel=type]").text(),o=e.find("td[rel=image] > img").attr("src");$("#dishes-edit-title").val(n);$("#dishes-edit-ingredients").text(r);$("#dishes-edit-price").val(i);$("#dishes-edit-type").val(s);$("#dishes-edit-item-id").text(t)});$("#dishes-edit-dlg-image-form").find(":button").click(function(){var e=new FormData($("#dishes-edit-dlg-image-form")[0]);$.ajax({url:"/dishes_image_upload",type:"POST",success:function(e){$("#dishes-edit-image-url-placeholder").text(e);$("#dishes-edit-image-section").html('<div class="alert alert-success">DODANO: '+e+".</div>")},error:function(e){alert(e)},data:e,cache:false,contentType:false,processData:false})});$("#dishes-edit-save-btn").on("click",function(){var t=$("#dishes-edit-title").val(),n=$("#dishes-edit-ingredients").val(),r=$("#dishes-edit-price").val(),s=$("#dishes-edit-type").val(),o=$("#dishes-edit-image-url-placeholder").text(),u=$("#dishes-edit-item-id").text(),a={title:t,ingredients:n,price:r,type:s,image:o,id:u};var f=false;$.each([t,r,s,n,u],function(e,t){if(t==null||t==""){f=true}});if(f==true){e.prepend('<div class="alert alert-danger">BŁĄD: Wszystkie pola są wymagane. Proszę poprawić.</div>')}else{$.postJSON("/dishes_edit",a,function(){$.get("admin",function(n){e.empty();e.html(n);admin.initEventHandlers();e.prepend('<div class="alert alert-success">ZMODYFIKOWANO pozycję na karcie dań: '+t+".</div>");i()})})}});var i=function(){$("#dishes-edit-dlg").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();$("#admin-tabs").find("a[rel=dishes]").tab("show")};var s=function(){$("#news-edit-dlg").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();$("#admin-tabs").find("a[rel=news]").tab("show")};var o=function(){$("#events-edit-dlg").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();$("#admin-tabs").find("a[rel=events]").tab("show")};var u=function(){$("#reservations-edit-dlg").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();$("#admin-tabs").find("a[rel=reservations]").tab("show")};$("#admin-gallery-add").find(":button").click(function(){var e=new FormData($("#admin-gallery-add")[0]);if(e!=null){$("#admin-gallery-add .ajax-loading").show();$.ajax({url:"/gallery_upload",type:"POST",success:function(e){$("#admin-gallery-tab").find("div.alert.alert-success").remove();$("#admin-gallery-tab").prepend('<div class="alert alert-success">DODANO: '+e+".</div>");$("#admin-gallery-add .ajax-loading").hide()},error:function(e){$("#admin-gallery-add .ajax-loading").hide();alert(e)},data:e,cache:false,contentType:false,processData:false})}else{alert("Proszę wybrać plik.")}});$(".img-to-enlarge").popover({html:true,trigger:"hover",placement:"right",content:function(){return'<img class="img-thumbnail img-responsive" style="float:right" src="'+this.src+'"/>'}})};$(document).ready(function(){admin.initLayout=$(function(){admin.initEventHandlers()})});var booking=booking||{};booking.initEventHandlers=function(){$(".navbar-collapse .navbar-nav > li > a").on("click",function(e){var t=$(this).attr("value").toLowerCase().replace(" ","");var n=$(this);$.get(t,function(e){$("#main-content").empty();$("#main-content").hide().html(e).fadeIn();$(".navbar-collapse .navbar-nav > li").removeClass("active");n.parent().addClass("active");switch(t){case"news":booking.jumbotronWide();news.initEventHandlers();break;case"calendar":booking.jumbotronHide();calendar.initLayout();$("#main-content #calendar-add-event").css("padding-top","0px");break;case"reservations":booking.jumbotronNarrow();reservations.initEventHandlers();$("#main-content #calendar-add-event").css("padding-top","0px");break;case"gallery":booking.jumbotronHide();gallery.initEventHandlers();break;case"dishes":booking.jumbotronHide();dishes.initEventHandlers();break;case"about":booking.jumbotronWide();break;case"admin":booking.jumbotronHide();admin.initEventHandlers();break}})});$("#login-dlg-logon-btn").on("click",function(e){var t=$("#login-mail").val();var n=$("#login-password").val();var r={email:t,password:n};$.postJSON("/login",r,function(e){if(Boolean(e.status)==true){alert("Logged.")}else{alert(e.desc)}})});$("#jumbotron-reservation").on("click",function(e){$.get("reservations",function(e){$("#main-content").empty();$("#main-content").html(e);reservations.initEventHandlers();booking.jumbotronNarrow();$("#main-content #calendar-add-event").css("padding-top","0px")})});$("#fb-plugin").hover(function(){$(this).stop().animate({right:"0"},"medium")},function(){$(this).stop().animate({right:"-245"},"medium")})};$(document).ready(function(){booking.initLayout=$(function(){booking.initEventHandlers()})});booking.jumbotronWide=function(){$(".jumbotron .btn-lg").show();$(".jumbotron").css("display","")};booking.jumbotronNarrow=function(){$(".jumbotron .btn-lg").hide();$(".jumbotron").css("display","")};booking.jumbotronHide=function(){$(".jumbotron .btn-lg").show();$(".jumbotron").css("display","none")};var calendar=calendar||{};calendar.initEventHandlers=function(){$(".fc-header-left .fc-button").removeClass().addClass("btn btn-primary");$(".fc-header-center .fc-button").removeClass().addClass("btn btn-primary");$(".fc-header-right .fc-button-today").removeClass().addClass("btn btn-primary");$(".fc-header-right .fc-button-prev").removeClass().addClass("btn btn-primary").text("<<");$(".fc-header-right .fc-button-next").removeClass().addClass("btn btn-primary").text(">>");$(".datepicker").datepicker({format:"yyyy-mm-dd",weekStart:1,autoclose:true});$(".timepicker").timepicker({showMeridian:false})};calendar.initLayout=function(){calendar.div="#calendar-div";$(calendar.div).fullCalendar({theme:false,firstDay:1,weekMode:"liquid",header:{left:"title",center:"month,agendaWeek,agendaDay",right:"today prev,next"},defaultView:"agendaWeek",allDaySlot:true,events:"/events_view",defaultEventMinutes:60,firstHour:7,minTime:6,maxTime:22,axisFormat:"H:mm",timeFormat:{"":"H:mm{-H:mm}",agenda:"H:mm{-H:mm}"},buttonText:{prev:"&lsaquo;",next:"&rsaquo;",prevYear:"&laquo;",nextYear:"&raquo;",today:"Dziś",month:"Miesiąc",week:"Tydzień",day:"Dzień"},monthNames:["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],monthNamesShort:["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","Paź","Lis","Gru"],dayNames:["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],dayNamesShort:["Nie","Pn","Wt","Śr","Czw","Pt","Sob"],dayClick:function(e,t,n,r){if(t){$(calendar.div).fullCalendar("changeView","agendaDay").fullCalendar("gotoDate",e.getFullYear(),e.getMonth(),e.getDate())}},eventClick:function(e,t,n){$("#event-edit-dlg").modal();$("#calendar-edit-event-date").val($.fullCalendar.formatDate(e.start,"yyyy-MM-dd")).datepicker("update");$("#calendar-edit-event-time-start").val($.fullCalendar.formatDate(e.start,"HH:mm"));$("#calendar-edit-event-time-end").val($.fullCalendar.formatDate(e.end,"HH:mm"));$("#calendar-edit-event-title").val(e.title);$("#calendar-edit-event-save-btn").unbind().on("click",function(t){var n=$("#calendar-edit-event-date").val();var r=$("#calendar-edit-event-time-start").val();var i=$("#calendar-edit-event-time-end").val();var s=$("#calendar-edit-event-title").val();var o={date_start:n+" "+r,date_end:n+" "+i,title:s,id:e.id};$.postJSON("/events_edit",o,function(e){if(Boolean(e.status)==true){$(calendar.div).fullCalendar("refetchEvents")}})})}});calendar.initEventHandlers()};var dishes=dishes||{};dishes.initEventHandlers=function(){$(".img-to-enlarge").popover({html:true,trigger:"hover",placement:"right",content:function(){return'<img class="img-thumbnail img-responsive" style="float:right" src="'+this.src+'"/>'}})};$(document).ready(function(){dishes.initLayout=$(function(){dishes.initEventHandlers()})});var gallery=gallery||{};gallery.initEventHandlers=function(){$(".least-gallery").least()};$(document).ready(function(){gallery.initLayout=$(function(){gallery.initEventHandlers()})});var news=news||{};news.initEventHandlers=function(){};$(document).ready(function(){news.initLayout=$(function(){news.initEventHandlers()})});var reservations=reservations||{};reservations.initEventHandlers=function(){$(".datepicker").datepicker({format:"yyyy-mm-dd",weekStart:1,autoclose:true});$(".timepicker").timepicker({showMeridian:false});$("#reservations-add-btn").on("click",function(e){$("#reservations-form").find(".alert").remove();var t=$("#reservation-date").val(),n=$("#reservation-time-start").val(),r=$("#reservation-time-end").val(),i=$("#reservation-title").val(),s=$("#reservation-phone").val(),o=$("#reservation-email").val();var u=false;$.each([t,n,r,i,s,o],function(e,t){if(t==null||t==""){u=true}});if(u==true){$("#reservations-form").prepend('<div class="alert alert-danger">BŁĄD: Wszystkie pola są wymagane. Proszę poprawić.</div>');return}var a={date_start:t+" "+n,date_end:t+" "+r,title:i,email:o,phone:s};$.postJSON("reservations_add",a,function(e){$.get("reservations",function(r){$("#main-content").empty();$("#main-content").html(r);reservations.initEventHandlers();booking.jumbotronNarrow();if(e.status==true){$("#reservations-form").prepend('<div class="alert alert-success">Rezerwacja zatwierdzona. Data: '+t+" "+n+".</div>")}})})})};jQuery.extend(jQuery.expr[":"],{focus:function(e){return e==document.activeElement}});$(document).ready(function(){jQuery.each(["delete","put"],function(e,t){jQuery[t]=function(e,n,r,i){if(jQuery.isFunction(n)){i=i||r;r=n;n=undefined}return jQuery.ajax({type:t,url:e,data:n,success:r,dataType:i})}});jQuery["postJSON"]=function(e,t,n){return jQuery.ajax({type:"POST",dataType:"json",contentType:"json",url:e,data:JSON.stringify(t),success:function(e){if(e!=null){if(!e.status){showError(e.desc)}if(jQuery.isFunction(n)){n(e)}}else{showError("Invalid response from the server")}}})};jQuery.ajaxSetup({cache:false,error:function(e,t){var n="";if(e.status==0){return}else if(e.status==404){n="Requested URL wasn't found."}else if(e.status==401){n="You are not authorized to access to this option/page."}else if(e.status==500){n="Internal Server Error occured."}else if(t=="parsererror"){return}else if(t=="timeout"){n="Request Timed out."}else{if(console){console.error(e.status)}return}}});var e="CookiesAccepted";$("#close-cookie-warn").click(function(){var t=new Date;t.setTime((new Date).getTime()+36e5*24*365);document.cookie=e+"=1;expires="+t;$("#cookie-warn").hide("slow")});var t="; "+document.cookie+";";var n=t.indexOf("; "+escape(e)+"=");if(n===-1){$("#cookie-warn").show()}})